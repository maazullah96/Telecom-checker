from fastapi import FastAPI, Request, HTTPException
from fastapi.responses import HTMLResponse
from fastapi.staticfiles import StaticFiles
from fastapi.templating import Jinja2Templates
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel
from typing import Optional
import logging

logging.basicConfig(level=logging.DEBUG)

app = FastAPI()

# Enable CORS
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Mount static and template directories
app.mount("/static", StaticFiles(directory="static"), name="static")
templates = Jinja2Templates(directory="templates")

# Telecom data
TELECOM_DATA = {
    "PK": {
        "country": "Pakistan",
        "operators": {
            "Country Code": ["+92"],
            "Zong": {"prefixes": ["0310", "0311", "0312", "0313", "0314", "0315", "0316","0317", "0318", "0319"], "mcc": "410", "mnc": "04"},
            "Telenor": {
                "prefixes": ["0340", "0341", "0342", "0343", "0344", "0345", "0346", "0347", "0348", "0349"],
                "mcc": "410",
                "mnc": "06",
            },
            "Jazz": {"prefixes": ["0300", "0301", "0302", "0303", "0304", "0305", "0306", "0307", "0308", "0309", "0320", "0321", "0322", "0323", "0324", "0325", "0326", "0327", "0328", "0329"], "mcc": "410", "mnc": "01"},
            "Ufone": {"prefixes": ["0330", "0331", "0332", "0333", "0334", "0335", "0336", "0337"], "mcc": "410", "mnc": "03"},
        },
    },
    "IN": {
    "country": "India",
    "operators": {
        "Country Code": ["+91"],
        "Jio": {
            "prefixes": ["7000", "7001", "7002", "7003", "7004", "7005", "7006", "7007", "7008", "7009"],
            "mcc": "404",
            "mnc": "01"
        },
        "Airtel": {
            "prefixes": ["9000", "9001", "9002", "9003", "9004", "9005", "9006", "9007", "9008", "9009"],
            "mcc": "404",
            "mnc": "02"
        },
        "Vodafone Idea": {
            "prefixes": ["8000", "8001", "8002", "8003", "8004", "8005", "8006", "8007", "8008", "8009"],
            "mcc": "404",
            "mnc": "03"
        },
        "BSNL": {
            "prefixes": ["9400", "9401", "9402", "9403", "9404", "9405", "9406", "9407", "9408", "9409"],
            "mcc": "404",
            "mnc": "04"
        }
    }
},
    "UK": {
        "country": "United Kingdom",
        "operators": {
            "Country Code": ["+44"],
            "EE": {"prefixes": ["0730", "0731", "0732", "0733", "0734", "0735", "0736", "0737", "0738", "0739", "0740"], "mcc": "234", "mnc": "30"},
            "Vodafone": {"prefixes": ["0740", "0741", "0742", "0743", "0744", "0745", "0746", "0747", "0748", "0749", "0750"], "mcc": "234", "mnc": "15"},
            "O2": {"prefixes": ["0750", "0751", "0752", "0753", "0754", "0755", "0756", "0757", "0758", "0759", "0760"], "mcc": "234", "mnc": "10"},
            "Three": {"prefixes": ["0760", "0761", "0762", "0763", "0764", "0765", "0766", "0767", "0768", "0769", "0770"], "mcc": "234", "mnc": "20"}
        }
    },
    "AU": {
        "country": "Australia",
        "operators": {
            "Country Code": ["+61"],
            "Telstra": {
                "prefixes": ["0400", "0401", "0402", "0403", "0404", "0405", "0406", "0407", "0408", "0409"],
                "mcc": "505",
                "mnc": "01"
            },
            "Optus": {
                "prefixes": ["0410", "0411", "0412", "0413", "0414", "0415", "0416", "0417", "0418", "0419"],
                "mcc": "505",
                "mnc": "02"
            },
            "Vodafone": {
                "prefixes": ["0420", "0421", "0422", "0423", "0424", "0425", "0426", "0427", "0428", "0429"],
                "mcc": "505",
                "mnc": "03"
            }
        }
    },
    "DE": {
    "country": "Germany",
    "operators": {
        "Country Code": ["+49"],
        "T-Mobile": {
            "prefixes": ["0151", "0152", "0153", "0154", "0155", "0156", "0157", "0158", "0159"],
            "mcc": "262",
            "mnc": "01"
        },
        "Vodafone": {
            "prefixes": ["0162", "0163", "0164", "0165", "0166", "0167", "0168", "0169", "0170"],
            "mcc": "262",
            "mnc": "02"
        },
        "O2": {
            "prefixes": ["0171", "0172", "0173", "0174", "0175", "0176", "0177", "0178", "0179"],
            "mcc": "262",
            "mnc": "03"
        }
    }
},

    "FR": {
    "country": "France",
    "operators": {
        "Country Code": ["+33"],
        "Orange": {
            "prefixes": ["0600", "0610", "0620", "0630", "0640", "0650", "0660", "0670", "0680", "0690"],
            "mcc": "208",
            "mnc": "01"
        },
        "SFR": {
            "prefixes": ["0630", "0640", "0650", "0660", "0670", "0680", "0690", "0700", "0710", "0720"],
            "mcc": "208",
            "mnc": "10"
        },
        "Bouygues Telecom": {
            "prefixes": ["0660", "0670", "0680", "0690", "0700", "0710", "0720", "0730", "0740", "0750"],
            "mcc": "208",
            "mnc": "20"
        }
    }
},

    "SA": {
    "country": "Saudi Arabia",
    "operators": {
        "Country Code": ["+966"],
        "STC": {
            "prefixes": ["0500", "0501", "0502", "0503", "0504", "0505", "0506", "0507", "0508", "0509"],
            "mcc": "420",
            "mnc": "01"
        },
        "Mobily": {
            "prefixes": ["0560", "0561", "0562", "0563", "0564", "0565", "0566", "0567", "0568", "0569"],
            "mcc": "420",
            "mnc": "03"
        },
        "Zain": {
            "prefixes": ["0590", "0591", "0592", "0593", "0594", "0595", "0596", "0597", "0598", "0599"],
            "mcc": "420",
            "mnc": "04"
        }
    }
},

    "JP": {
    "country": "Japan",
    "operators": {
        "Country Code": ["+81"],
        "NTT Docomo": {
            "prefixes": ["090", "080", "070", "071", "072", "073", "074", "075", "076", "077"],
            "mcc": "440",
            "mnc": "10"
        },
        "KDDI au": {
            "prefixes": ["0701", "0801", "0901", "0703", "0803", "0903", "0704", "0804", "0904", "0705"],
            "mcc": "440",
            "mnc": "50"
        },
        "SoftBank": {
            "prefixes": ["0702", "0802", "0902", "0706", "0806", "0906", "0707", "0807", "0907", "0708"],
            "mcc": "440",
            "mnc": "20"
        }
    }
},

    "CN": {
    "country": "China",
    "operators": {
        "Country Code": ["+86"],
        "China Mobile": {
            "prefixes": ["1380", "1390", "1500", "1510", "1520", "1570", "1580", "1590", "1820", "1830"],
            "mcc": "460",
            "mnc": "00"
        },
        "China Unicom": {
            "prefixes": ["1300", "1310", "1320", "1550", "1560", "1850", "1860", "1450", "1460", "1470"],
            "mcc": "460",
            "mnc": "01"
        },
        "China Telecom": {
            "prefixes": ["1330", "1340", "1350", "1360", "1370", "1380", "1530", "1890", "1800", "1810"],
            "mcc": "460",
            "mnc": "02"
        }
    }
},

    "BR": {
    "country": "Brazil",
    "operators": {
        "Country Code": ["+55"],
        "Vivo": {
            "prefixes": ["0110", "0150", "0210", "0130", "0140", "0160", "0170", "0180", "0190", "0200"],
            "mcc": "724",
            "mnc": "10"
        },
        "Claro": {
            "prefixes": ["0410", "0420", "0430", "0440", "0450", "0460", "0470", "0480", "0490", "0500"],
            "mcc": "724",
            "mnc": "05"
        },
        "TIM": {
            "prefixes": ["0810", "0820", "0830", "0840", "0850", "0860", "0870", "0880", "0890", "0900"],
            "mcc": "724",
            "mnc": "03"
        }
    }
},

    "ZA": {
    "country": "South Africa",
    "operators": {
        "Country Code": ["+27"],
        "Vodacom": {
            "prefixes": ["0710", "0720", "0730", "0740", "0750", "0760", "0770", "0780", "0790", "0800"],
            "mcc": "655",
            "mnc": "01"
        },
        "MTN": {
            "prefixes": ["0740", "0750", "0760", "0770", "0780", "0790", "0800", "0810", "0820", "0830"],
            "mcc": "655",
            "mnc": "02"
        },
        "Cell C": {
            "prefixes": ["0780", "0790", "0800", "0810", "0820", "0830", "0840", "0850", "0860", "0870"],
            "mcc": "655",
            "mnc": "07"
        }
    }
},

    "AE": {
    "country": "United Arab Emirates",
    "operators": {
        "Country Code": ["+971"],
        "Etisalat": {
            "prefixes": ["0500", "0501", "0502", "0540", "0541", "0542", "0560", "0561", "0562", "0563"],
            "mcc": "424",
            "mnc": "02"
        },
        "du": {
            "prefixes": ["0550", "0551", "0552", "0520", "0521", "0522", "0523", "0524", "0525", "0526"],
            "mcc": "424",
            "mnc": "03"
        }
    }
},

    "CA": {
    "country": "Canada",
    "operators": {
        "Country Code": ["+1"],
        "Rogers": {
            "prefixes": ["4160", "4161", "4162", "6470", "6471", "6472", "9050", "9051", "9052", "9053"],
            "mcc": "302",
            "mnc": "72"
        },
        "Bell": {
            "prefixes": ["2040", "2041", "2042", "4310", "4311", "4312", "5140", "5141", "5142", "5143"],
            "mcc": "302",
            "mnc": "61"
        },
        "Telus": {
            "prefixes": ["5870", "5871", "5872", "7800", "7801", "7802", "8250", "8251", "8252", "8253"],
            "mcc": "302",
            "mnc": "22"
        }
    }
},

    "US": {
    "country": "United States",
    "operators": {
        "Country Code": ["+1"],
        "Verizon": {
            "prefixes": ["2010", "2011", "2012", "2020", "2021", "2022", "2030", "2031", "2032", "2040"],
            "mcc": "310",
            "mnc": "12"
        },
        "AT&T": {
            "prefixes": ["2100", "2101", "2102", "2110", "2111", "2112", "2120", "2121", "2122", "2130"],
            "mcc": "310",
            "mnc": "17"
        },
        "T-Mobile": {
            "prefixes": ["3100", "3101", "3102", "3110", "3111", "3112", "3120", "3121", "3122", "3130"],
            "mcc": "310",
            "mnc": "26"
        },
        "Sprint": {
            "prefixes": ["7200", "7201", "7202", "7210", "7211", "7212", "7220", "7221", "7222", "7230"],
            "mcc": "310",
            "mnc": "20"
        }
    }
},

    "IT": {
    "country": "Italy",
    "operators": {
        "Country Code": ["+39"],
        "TIM": {
            "prefixes": ["3200", "3201", "3202", "3280", "3281", "3282", "3300", "3301", "3302", "3310"],
            "mcc": "222",
            "mnc": "01"
        },
        "Vodafone": {
            "prefixes": ["3400", "3401", "3402", "3420", "3421", "3422", "3450", "3451", "3452", "3460"],
            "mcc": "222",
            "mnc": "10"
        },
        "WindTre": {
            "prefixes": ["3500", "3501", "3502", "3600", "3601", "3602", "3650", "3651", "3652", "3660"],
            "mcc": "222",
            "mnc": "88"
        }
    }
},

    "ES": {
    "country": "Spain",
    "operators": {
        "Country Code": ["+34"],
        "Movistar": {
            "prefixes": ["6100", "6101", "6102", "6110", "6111", "6112", "6120", "6121", "6122", "6130"],
            "mcc": "214",
            "mnc": "07"
        },
        "Vodafone": {
            "prefixes": ["6400", "6401", "6402", "6450", "6451", "6452", "6500", "6501", "6502", "6510"],
            "mcc": "214",
            "mnc": "01"
        },
        "Orange": {
            "prefixes": ["6700", "6701", "6702", "6750", "6751", "6752", "6800", "6801", "6802", "6810"],
            "mcc": "214",
            "mnc": "03"
        }
    }
},

    "RU": {
    "country": "Russia",
    "operators": {
        "Country Code": ["+7"],
        "MTS": {
            "prefixes": ["9100", "9101", "9102", "9110", "9111", "9112", "9120", "9121", "9122", "9130"],
            "mcc": "250",
            "mnc": "01"
        },
        "Beeline": {
            "prefixes": ["9200", "9201", "9202", "9210", "9211", "9212", "9220", "9221", "9222", "9230"],
            "mcc": "250",
            "mnc": "99"
        },
        "Megafon": {
            "prefixes": ["9300", "9301", "9302", "9310", "9311", "9312", "9320", "9321", "9322", "9330"],
            "mcc": "250",
            "mnc": "02"
        }
    }
},

    "MX": {
    "country": "Mexico",
    "operators": {
        "Country Code": ["+52"],
        "Telcel": {
            "prefixes": ["5500", "5501", "5502", "5520", "5521", "5522", "5540", "5541", "5542", "5550"],
            "mcc": "334",
            "mnc": "20"
        },
        "Movistar": {
            "prefixes": ["5600", "5601", "5602", "5610", "5611", "5612", "5620", "5621", "5622", "5630"],
            "mcc": "334",
            "mnc": "030"
        },
        "AT&T Mexico": {
            "prefixes": ["5800", "5801", "5802", "5810", "5811", "5812", "5820", "5821", "5822", "5830"],
            "mcc": "334",
            "mnc": "050"
        }
    }
},

    "NZ": {
    "country": "New Zealand",
    "operators": {
        "Country Code": ["+64"],
        "Spark": {
            "prefixes": ["2000", "2001", "2002", "2010", "2011", "2012", "2020", "2021", "2022", "2030"],
            "mcc": "530",
            "mnc": "01"
        },
        "Vodafone NZ": {
            "prefixes": ["2100", "2101", "2102", "2110", "2111", "2112", "2120", "2121", "2122", "2130"],
            "mcc": "530",
            "mnc": "02"
        },
        "2degrees": {
            "prefixes": ["2200", "2201", "2202", "2210", "2211", "2212", "2220", "2221", "2222", "2230"],
            "mcc": "530",
            "mnc": "24"
        }
    }
},

 "TR": {
    "country": "Turkey",
    "operators": {
        "Country Code": ["+90"],
        "Turkcell": {
            "prefixes": ["5300", "5301", "5302", "5310", "5311", "5312", "5320", "5321", "5322", "5330"],
            "mcc": "286",
            "mnc": "01"
        },
        "Vodafone Turkey": {
            "prefixes": ["5400", "5401", "5402", "5410", "5411", "5412", "5420", "5421", "5422", "5430"],
            "mcc": "286",
            "mnc": "02"
        },
        "Türk Telekom": {
            "prefixes": ["5500", "5501", "5502", "5510", "5511", "5512", "5520", "5521", "5522", "5530"],
            "mcc": "286",
            "mnc": "03"
        }
    }
},
    "KR": {
    "country": "South Korea",
    "operators": {
        "Country Code": ["+82"],
        "SK Telecom": {
            "prefixes": ["0100", "0101", "0102", "0110", "0111", "0112", "0120", "0121", "0122", "0130"],
            "mcc": "450",
            "mnc": "05"
        },
        "KT Corporation": {
            "prefixes": ["0130", "0131", "0132", "0140", "0141", "0142", "0150", "0151", "0152", "0160"],
            "mcc": "450",
            "mnc": "02"
        },
        "LG Uplus": {
            "prefixes": ["0160", "0161", "0162", "0170", "0171", "0172", "0180", "0181", "0182", "0190"],
            "mcc": "450",
            "mnc": "06"
        }
    }
},
    "ID": {
    "country": "Indonesia",
    "operators": {
        "Country Code": ["+62"],
        "Telkomsel": {
            "prefixes": ["0810", "0811", "0812", "0813", "0814", "0815", "0816", "0817", "0818", "0819"],
            "mcc": "510",
            "mnc": "10"
        },
        "XL Axiata": {
            "prefixes": ["0817", "0818", "0819", "0820", "0821", "0822", "0823", "0824", "0825", "0826"],
            "mcc": "510",
            "mnc": "11"
        },
        "Indosat Ooredoo": {
            "prefixes": ["0855", "0856", "0857", "0858", "0859", "0860", "0861", "0862", "0863", "0864"],
            "mcc": "510",
            "mnc": "01"
        }
    }
},
"MY": {
    "country": "Malaysia",
    "operators": {
        "Country Code": ["+60"],
        "Maxis": {
            "prefixes": ["0120", "0121", "0122", "0170", "0171", "0172", "0110", "0111", "0112", "0113"],
            "mcc": "502",
            "mnc": "12"
        },
        "Celcom": {
            "prefixes": ["0190", "0191", "0192", "0130", "0131", "0132", "0111", "0112", "0113", "0114"],
            "mcc": "502",
            "mnc": "13"
        },
        "Digi": {
            "prefixes": ["0160", "0161", "0162", "0140", "0141", "0142", "0112", "0113", "0114", "0115"],
            "mcc": "502",
            "mnc": "10"
        }
    }
},
    "SG": {
    "country": "Singapore",
    "operators": {
        "Country Code": ["+65"],
        "Singtel": {
            "prefixes": ["8310", "8311", "8312", "8320", "8321", "8322", "8330", "8331", "8332", "8340"],
            "mcc": "525",
            "mnc": "01"
        },
        "StarHub": {
            "prefixes": ["8510", "8511", "8512", "8520", "8521", "8522", "8530", "8531", "8532", "8540"],
            "mcc": "525",
            "mnc": "02"
        },
        "M1": {
            "prefixes": ["8710", "8711", "8712", "8720", "8721", "8722", "8730", "8731", "8732", "8740"],
            "mcc": "525",
            "mnc": "03"
        }
    }
},
"AR": {
    "country": "Argentina",
    "operators": {
        "Country Code": ["+54"],
        "Claro": {
            "prefixes": ["3400", "3401", "3402", "3410", "3411", "3412", "3420", "3421", "3422", "3430"],
            "mcc": "722",
            "mnc": "310"
        },
        "Movistar": {
            "prefixes": ["3200", "3201", "3202", "3210", "3211", "3212", "3220", "3221", "3222", "3230"],
            "mcc": "722",
            "mnc": "07"
        },
        "Personal": {
            "prefixes": ["3700", "3701", "3702", "3710", "3711", "3712", "3720", "3721", "3722", "3730"],
            "mcc": "722",
            "mnc": "34"
        }
    }
},
    "SS": {
    "country": "South Sudan",
    "operators": {
        "Country Code": ["+211"],
        "MTN": {
            "prefixes": ["0920", "0921", "0922", "0923", "0924", "0925", "0926", "0927", "0928", "0929"],
            "mcc": "659",
            "mnc": "02"
        },
        "Zain": {
            "prefixes": ["0910", "0911", "0912", "0913", "0914", "0915", "0916", "0917", "0918", "0919"],
            "mcc": "659",
            "mnc": "03"
        }
    }
},
"EG": {
    "country": "Egypt",
    "operators": {
        "Country Code": ["+20"],
        "Vodafone Egypt": {
            "prefixes": ["0100", "0101", "0102", "0103", "0104", "0105", "0106", "0107", "0108", "0109"],
            "mcc": "602",
            "mnc": "02"
        },
        "Orange Egypt": {
            "prefixes": ["0120", "0121", "0122", "0123", "0124", "0125", "0126", "0127", "0128", "0129"],
            "mcc": "602",
            "mnc": "03"
        },
        "Etisalat Misr": {
            "prefixes": ["0110", "0111", "0112", "0113", "0114", "0115", "0116", "0117", "0118", "0119"],
            "mcc": "602",
            "mnc": "04"
        }
    }
},
    "NG": {
    "country": "Nigeria",
    "operators": {
        "Country Code": ["+234"],
        "MTN Nigeria": {
            "prefixes": ["0803", "0804", "0805", "0806", "0703", "0704", "0705", "0706", "0903", "0906"],
            "mcc": "621",
            "mnc": "30"
        },
        "Glo Mobile": {
            "prefixes": ["0805", "0807", "0808", "0810", "0815", "0816", "0817", "0905", "0907", "0908"],
            "mcc": "621",
            "mnc": "50"
        },
        "Airtel Nigeria": {
            "prefixes": ["0802", "0808", "0809", "0701", "0702", "0708", "0902", "0908", "0909", "0707"],
            "mcc": "621",
            "mnc": "10"
        }
    }
},
"BD": {
    "country": "Bangladesh",
    "operators": {
        "Country Code": ["+880"],
        "Grameenphone": {
            "prefixes": ["0170", "0171", "0172", "0173", "0174", "0175", "0176", "0177", "0178", "0179"],
            "mcc": "470",
            "mnc": "01"
        },
        "Robi": {
            "prefixes": ["0180", "0181", "0182", "0183", "0184", "0185", "0186", "0187", "0188", "0189"],
            "mcc": "470",
            "mnc": "02"
        },
        "Banglalink": {
            "prefixes": ["0190", "0191", "0192", "0193", "0194", "0195", "0196", "0197", "0198", "0199"],
            "mcc": "470",
            "mnc": "03"
        }
    }
},
"VN": {
    "country": "Vietnam",
    "operators": {
        "Country Code": ["+84"],
        "Viettel": {
            "prefixes": ["0980", "0981", "0982", "0983", "0984", "0985", "0986", "0987", "0988", "0989"],
            "mcc": "452",
            "mnc": "04"
        },
        "Vinaphone": {
            "prefixes": ["0910", "0911", "0912", "0913", "0914", "0915", "0916", "0917", "0918", "0919"],
            "mcc": "452",
            "mnc": "02"
        },
        "Mobifone": {
            "prefixes": ["0900", "0901", "0902", "0903", "0904", "0905", "0906", "0907", "0908", "0909"],
            "mcc": "452",
            "mnc": "01"
        }
    }
},
    "PH": {
    "country": "Philippines",
    "operators": {
        "Country Code": ["+63"],
        "Globe": {
            "prefixes": ["0917", "0918", "0919", "0927", "0928", "0929", "0935", "0936", "0937", "0938"],
            "mcc": "515",
            "mnc": "02"
        },
        "Smart": {
            "prefixes": ["0908", "0909", "0910", "0918", "0919", "0920", "0949", "0950", "0951", "0952"],
            "mcc": "515",
            "mnc": "03"
        },
        "Sun Cellular": {
            "prefixes": ["0922", "0923", "0924", "0933", "0934", "0935", "0936", "0937", "0938", "0939"],
            "mcc": "515",
            "mnc": "04"
        }
    }
},
"TH": {
    "country": "Thailand",
    "operators": {
        "Country Code": ["+66"],
        "AIS": {
            "prefixes": ["0810", "0811", "0812", "0813", "0814", "0815", "0816", "0817", "0818", "0819"],
            "mcc": "520",
            "mnc": "01"
        },
        "TrueMove": {
            "prefixes": ["0900", "0901", "0902", "0903", "0904", "0905", "0906", "0907", "0908", "0909"],
            "mcc": "520",
            "mnc": "99"
        },
        "DTAC": {
            "prefixes": ["0850", "0851", "0852", "0853", "0854", "0855", "0856", "0857", "0858", "0859"],
            "mcc": "520",
            "mnc": "18"
        }
    }
},
"PL": {
    "country": "Poland",
    "operators": {
        "Country Code": ["+48"],
        "Orange": {
            "prefixes": ["5010", "5011", "5012", "5020", "5021", "5022", "5030", "5031", "5032", "5040"],
            "mcc": "260",
            "mnc": "03"
        },
        "T-Mobile": {
            "prefixes": ["6010", "6011", "6012", "6020", "6021", "6022", "6030", "6031", "6032", "6040"],
            "mcc": "260",
            "mnc": "02"
        },
        "Play": {
            "prefixes": ["7910", "7911", "7912", "7920", "7921", "7922", "7930", "7931", "7932", "7940"],
            "mcc": "260",
            "mnc": "06"
        }
    }
},
    "UA": {
    "country": "Ukraine",
    "operators": {
        "Country Code": ["+380"],
        "Kyivstar": {
            "prefixes": ["0670", "0671", "0672", "0680", "0681", "0682", "0960", "0961", "0962", "0970"],
            "mcc": "255",
            "mnc": "01"
        },
        "Vodafone UA": {
            "prefixes": ["0500", "0501", "0502", "0660", "0661", "0662", "0950", "0951", "0952", "0960"],
            "mcc": "255",
            "mnc": "02"
        },
        "Lifecell": {
            "prefixes": ["0630", "0631", "0632", "0730", "0731", "0732", "0930", "0931", "0932", "0940"],
            "mcc": "255",
            "mnc": "03"
        }
    }
},
"GR": {
    "country": "Greece",
    "operators": {
        "Country Code": ["+30"],
        "Cosmote": {
            "prefixes": ["6900", "6901", "6902", "6910", "6911", "6912", "6930", "6931", "6932", "6940"],
            "mcc": "202",
            "mnc": "01"
        },
        "Vodafone GR": {
            "prefixes": ["6940", "6941", "6942", "6950", "6951", "6952", "6960", "6961", "6962", "6970"],
            "mcc": "202",
            "mnc": "05"
        },
        "Wind GR": {
            "prefixes": ["6980", "6981", "6982", "6990", "6991", "6992", "6970", "6971", "6972", "7000"],
            "mcc": "202",
            "mnc": "10"
        }
    }
},
"PT": {
    "country": "Portugal",
    "operators": {
        "Country Code": ["+351"],
        "MEO": {
            "prefixes": ["9100", "9101", "9102", "9110", "9111", "9112", "9120", "9121", "9122", "9130"],
            "mcc": "268",
            "mnc": "06"
        },
        "Vodafone PT": {
            "prefixes": ["9200", "9201", "9202", "9210", "9211", "9212", "9220", "9221", "9222", "9230"],
            "mcc": "268",
            "mnc": "01"
        },
        "NOS": {
            "prefixes": ["9300", "9301", "9302", "9310", "9311", "9312", "9320", "9321", "9322", "9330"],
            "mcc": "268",
            "mnc": "03"
        }
    }
},

   "CL": {
    "country": "Chile",
    "operators": {
        "Country Code": ["+56"],
        "Entel": {
            "prefixes": ["9700", "9701", "9702", "9710", "9711", "9712", "9720", "9721", "9722", "9730"],
            "mcc": "730",
            "mnc": "01"
        },
        "Movistar": {
            "prefixes": ["9810", "9811", "9812", "9820", "9821", "9822", "9830", "9831", "9832", "9840"],
            "mcc": "730",
            "mnc": "02"
        },
        "Claro": {
            "prefixes": ["9910", "9911", "9912", "9920", "9921", "9922", "9930", "9931", "9932", "9940"],
            "mcc": "730",
            "mnc": "03"
        }
    }
},
"CO": {
    "country": "Colombia",
    "operators": {
        "Country Code": ["+57"],
        "Claro": {
            "prefixes": ["3100", "3101", "3102", "3110", "3111", "3112", "3120", "3121", "3122", "3130"],
            "mcc": "732",
            "mnc": "101"
        },
        "Movistar": {
            "prefixes": ["3130", "3131", "3132", "3140", "3141", "3142", "3150", "3151", "3152", "3160"],
            "mcc": "732",
            "mnc": "123"
        },
        "Tigo": {
            "prefixes": ["3160", "3161", "3162", "3170", "3171", "3172", "3180", "3181", "3182", "3190"],
            "mcc": "732",
            "mnc": "103"
        }
    }
},
"KE": {
    "country": "Kenya",
    "operators": {
        "Country Code": ["+254"],
        "Safaricom": {
            "prefixes": ["0700", "0701", "0702", "0710", "0711", "0712", "0720", "0721", "0722", "0730"],
            "mcc": "639",
            "mnc": "02"
        },
        "Airtel Kenya": {
            "prefixes": ["0730", "0731", "0732", "0740", "0741", "0742", "0750", "0751", "0752", "0760"],
            "mcc": "639",
            "mnc": "03"
        },
        "Telkom Kenya": {
            "prefixes": ["0770", "0771", "0772", "0780", "0781", "0782", "0790", "0791", "0792", "0800"],
            "mcc": "639",
            "mnc": "04"
        }
    }
},
    "UG": {
    "country": "Uganda",
    "operators": {
        "Country Code": ["+256"],
        "MTN Uganda": {
            "prefixes": ["0770", "0771", "0772", "0780", "0781", "0782", "0790", "0791", "0792", "0800"],
            "mcc": "641",
            "mnc": "10"
        },
        "Airtel Uganda": {
            "prefixes": ["0700", "0701", "0702", "0750", "0751", "0752", "0760", "0761", "0762", "0770"],
            "mcc": "641",
            "mnc": "11"
        }
    }
},
"TZ": {
    "country": "Tanzania",
    "operators": {
        "Country Code": ["+255"],
        "Vodacom Tanzania": {
            "prefixes": ["0750", "0751", "0752", "0760", "0761", "0762", "0770", "0771", "0772", "0780"],
            "mcc": "640",
            "mnc": "04"
        },
        "Tigo Tanzania": {
            "prefixes": ["0710", "0711", "0712", "0730", "0731", "0732", "0740", "0741", "0742", "0750"],
            "mcc": "640",
            "mnc": "07"
        }
    }
},
"MA": {
    "country": "Morocco",
    "operators": {
        "Country Code": ["+212"],
        "Maroc Telecom": {
            "prefixes": ["0600", "0601", "0602", "0610", "0611", "0612", "0620", "0621", "0622", "0630"],
            "mcc": "604",
            "mnc": "01"
        },
        "Orange Maroc": {
            "prefixes": ["0630", "0631", "0632", "0640", "0641", "0642", "0650", "0651", "0652", "0660"],
            "mcc": "604",
            "mnc": "02"
        },
        "Inwi": {
            "prefixes": ["0660", "0661", "0662", "0670", "0671", "0672", "0680", "0681", "0682", "0690"],
            "mcc": "604",
            "mnc": "03"
        }
    }
},
    "DZ": {
    "country": "Algeria",
    "operators": {
        "Country Code": ["+213"],
        "Mobilis": {
            "prefixes": ["0660", "0661", "0662", "0663", "0664", "0665", "0666", "0667", "0668", "0669"],
            "mcc": "603",
            "mnc": "01"
        },
        "Djezzy": {
            "prefixes": ["0770", "0771", "0772", "0773", "0774", "0775", "0776", "0777", "0778", "0779"],
            "mcc": "603",
            "mnc": "02"
        },
        "Ooredoo": {
            "prefixes": ["0550", "0551", "0552", "0553", "0554", "0555", "0556", "0557", "0558", "0559"],
            "mcc": "603",
            "mnc": "03"
        }
    }
},
"TN": {
    "country": "Tunisia",
    "operators": {
        "Country Code": ["+216"],
        "Tunisie Telecom": {
            "prefixes": ["2100", "2101", "2102", "2110", "2111", "2112", "2120", "2121", "2122", "2130"],
            "mcc": "605",
            "mnc": "01"
        },
        "Orange Tunisie": {
            "prefixes": ["2200", "2201", "2202", "2210", "2211", "2212", "2220", "2221", "2222", "2230"],
            "mcc": "605",
            "mnc": "03"
        },
        "Ooredoo Tunisie": {
            "prefixes": ["2300", "2301", "2302", "2310", "2311", "2312", "2320", "2321", "2322", "2330"],
            "mcc": "605",
            "mnc": "02"
        }
    }
},
"ET": {
    "country": "Ethiopia",
    "operators": {
        "Country Code": ["+251"],
        "Ethio Telecom": {
            "prefixes": ["0900", "0901", "0902", "0910", "0911", "0912", "0920", "0921", "0922", "0930"],
            "mcc": "636",
            "mnc": "01"
        }
    }
},
"SA": {
    "country": "Saudi Arabia",
    "operators": {
        "Country Code": ["+966"],
        "STC": {
            "prefixes": ["0500", "0501", "0502", "0550", "0551", "0552", "0560", "0561", "0562", "0570"],
            "mcc": "420",
            "mnc": "01"
        },
        "Mobily": {
            "prefixes": ["0540", "0541", "0542", "0570", "0571", "0572", "0580", "0581", "0582", "0590"],
            "mcc": "420",
            "mnc": "03"
        },
        "Zain KSA": {
            "prefixes": ["0590", "0591", "0592", "0593", "0594", "0595", "0596", "0597", "0598", "0599"],
            "mcc": "420",
            "mnc": "04"
        }
    }
},
    "AE": {
    "country": "United Arab Emirates",
    "operators": {
        "Country Code": ["+971"],
        "Etisalat": {
            "prefixes": ["0500", "0501", "0502", "0550", "0551", "0552", "0560", "0561", "0562", "0570"],
            "mcc": "424",
            "mnc": "02"
        },
        "du": {
            "prefixes": ["0520", "0521", "0522", "0540", "0541", "0542", "0580", "0581", "0582", "0590"],
            "mcc": "424",
            "mnc": "03"
        }
    }
},
"QA": {
    "country": "Qatar",
    "operators": {
        "Country Code": ["+974"],
        "Ooredoo Qatar": {
            "prefixes": ["4400", "4401", "4402", "4410", "4411", "4412", "4420", "4421", "4422", "4430"],
            "mcc": "427",
            "mnc": "01"
        },
        "Vodafone Qatar": {
            "prefixes": ["4430", "4431", "4432", "4440", "4441", "4442", "4450", "4451", "4452", "4460"],
            "mcc": "427",
            "mnc": "02"
        }
    }
},
"KW": {
    "country": "Kuwait",
    "operators": {
        "Country Code": ["+965"],
        "Zain Kuwait": {
            "prefixes": ["9600", "9601", "9602", "9610", "9611", "9612", "9620", "9621", "9622", "9630"],
            "mcc": "419",
            "mnc": "01"
        },
        "Ooredoo Kuwait": {
            "prefixes": ["9630", "9631", "9632", "9640", "9641", "9642", "9650", "9651", "9652", "9660"],
            "mcc": "419",
            "mnc": "02"
        },
        "STC Kuwait": {
            "prefixes": ["9660", "9661", "9662", "9670", "9671", "9672", "9680", "9681", "9682", "9690"],
            "mcc": "419",
            "mnc": "03"
        }
    }
},
"OM": {
    "country": "Oman",
    "operators": {
        "Country Code": ["+968"],
        "Omantel": {
            "prefixes": ["9000", "9001", "9002", "9010", "9011", "9012", "9020", "9021", "9022", "9030"],
            "mcc": "422",
            "mnc": "01"
        },
        "Ooredoo Oman": {
            "prefixes": ["9030", "9031", "9032", "9040", "9041", "9042", "9050", "9051", "9052", "9060"],
            "mcc": "422",
            "mnc": "02"
        }
    }
},
    "BH": {
    "country": "Bahrain",
    "operators": {
        "Country Code": ["+973"],
        "Batelco": {
            "prefixes": ["3600", "3601", "3602", "3610", "3611", "3612", "3620", "3621", "3622", "3630"],
            "mcc": "426",
            "mnc": "01"
        },
        "STC Bahrain": {
            "prefixes": ["3700", "3701", "3702", "3710", "3711", "3712", "3720", "3721", "3722", "3730"],
            "mcc": "426",
            "mnc": "02"
        },
        "Zain Bahrain": {
            "prefixes": ["3800", "3801", "3802", "3810", "3811", "3812", "3820", "3821", "3822", "3830"],
            "mcc": "426",
            "mnc": "03"
        }
    }
},
"ZA": {
    "country": "South Africa",
    "operators": {
        "Country Code": ["+27"],
        "Vodacom": {
            "prefixes": ["0820", "0821", "0822", "0830", "0831", "0832", "0840", "0841", "0842", "0850"],
            "mcc": "655",
            "mnc": "01"
        },
        "MTN": {
            "prefixes": ["0831", "0832", "0833", "0841", "0842", "0843", "0851", "0852", "0853", "0860"],
            "mcc": "655",
            "mnc": "02"
        },
        "Cell C": {
            "prefixes": ["0842", "0843", "0844", "0852", "0853", "0854", "0862", "0863", "0864", "0870"],
            "mcc": "655",
            "mnc": "07"
        }
    }
},
"ZW": {
    "country": "Zimbabwe",
    "operators": {
        "Country Code": ["+263"],
        "Econet": {
            "prefixes": ["0770", "0771", "0772", "0780", "0781", "0782", "0790", "0791", "0792", "0800"],
            "mcc": "648",
            "mnc": "01"
        },
        "NetOne": {
            "prefixes": ["0710", "0711", "0712", "0730", "0731", "0732", "0740", "0741", "0742", "0750"],
            "mcc": "648",
            "mnc": "03"
        }
    }
},
"MZ": {
    "country": "Mozambique",
    "operators": {
        "Country Code": ["+258"],
        "Movitel": {
            "prefixes": ["8200", "8201", "8202", "8210", "8211", "8212", "8220", "8221", "8222", "8230"],
            "mcc": "643",
            "mnc": "03"
        },
        "Vodacom Mozambique": {
            "prefixes": ["8400", "8401", "8402", "8410", "8411", "8412", "8420", "8421", "8422", "8430"],
            "mcc": "643",
            "mnc": "01"
        }
    }
},
    "ZM": {
    "country": "Zambia",
    "operators": {
        "Country Code": ["+260"],
        "MTN Zambia": {
            "prefixes": ["0960", "0961", "0962", "0970", "0971", "0972", "0980", "0981", "0982", "0990"],
            "mcc": "645",
            "mnc": "02"
        },
        "Zamtel": {
            "prefixes": ["0950", "0951", "0952", "0940", "0941", "0942", "0930", "0931", "0932", "0920"],
            "mcc": "645",
            "mnc": "01"
        }
    }
},
"AO": {
    "country": "Angola",
    "operators": {
        "Country Code": ["+244"],
        "Unitel": {
            "prefixes": ["9100", "9101", "9102", "9110", "9111", "9112", "9120", "9121", "9122", "9130"],
            "mcc": "631",
            "mnc": "02"
        },
        "Movicel": {
            "prefixes": ["9300", "9301", "9302", "9310", "9311", "9312", "9320", "9321", "9322", "9330"],
            "mcc": "631",
            "mnc": "01"
        }
    }
},
"BW": {
    "country": "Botswana",
    "operators": {
        "Country Code": ["+267"],
        "Mascom": {
            "prefixes": ["7100", "7101", "7102", "7110", "7111", "7112", "7120", "7121", "7122", "7130"],
            "mcc": "652",
            "mnc": "01"
        },
        "Orange Botswana": {
            "prefixes": ["7130", "7131", "7132", "7140", "7141", "7142", "7150", "7151", "7152", "7160"],
            "mcc": "652",
            "mnc": "02"
        }
    }
},
"AF": {
    "country": "Afghanistan",
    "operators": {
        "Country Code": ["+93"],
        "Roshan": {
            "prefixes": ["0790", "0791", "0792", "0793", "0794", "0795", "0796", "0797", "0798", "0799"],
            "mcc": "412",
            "mnc": "01"
        },
        "Etisalat Afghanistan": {
            "prefixes": ["0780", "0781", "0782", "0783", "0784", "0785", "0786", "0787", "0788", "0789"],
            "mcc": "412",
            "mnc": "02"
        },
        "AWCC": {
            "prefixes": ["0700", "0701", "0702", "0703", "0704", "0705", "0706", "0707", "0708", "0709"],
            "mcc": "412",
            "mnc": "03"
        }
    }
},
    "LK": {
    "country": "Sri Lanka",
    "operators": {
        "Country Code": ["+94"],
        "Dialog": {
            "prefixes": ["0770", "0771", "0772", "0773", "0774", "0775", "0776", "0777", "0778", "0779"],
            "mcc": "413",
            "mnc": "01"
        },
        "Mobitel": {
            "prefixes": ["0710", "0711", "0712", "0713", "0714", "0715", "0716", "0717", "0718", "0719"],
            "mcc": "413",
            "mnc": "02"
        },
        "Hutch": {
            "prefixes": ["0780", "0781", "0782", "0783", "0784", "0785", "0786", "0787", "0788", "0789"],
            "mcc": "413",
            "mnc": "08"
        }
    }
},
"MV": {
    "country": "Maldives",
    "operators": {
        "Country Code": ["+960"],
        "Dhiraagu": {
            "prefixes": ["7700", "7701", "7702", "7710", "7711", "7712", "7720", "7721", "7722", "7730"],
            "mcc": "472",
            "mnc": "01"
        },
        "Ooredoo Maldives": {
            "prefixes": ["7600", "7601", "7602", "7610", "7611", "7612", "7620", "7621", "7622", "7630"],
            "mcc": "472",
            "mnc": "02"
        }
    }
},
"NP": {
    "country": "Nepal",
    "operators": {
        "Country Code": ["+977"],
        "Nepal Telecom": {
            "prefixes": ["9840", "9841", "9842", "9850", "9851", "9852", "9860", "9861", "9862", "9870"],
            "mcc": "429",
            "mnc": "01"
        },
        "Ncell": {
            "prefixes": ["9800", "9801", "9802", "9810", "9811", "9812", "9820", "9821", "9822", "9830"],
            "mcc": "429",
            "mnc": "02"
        },
        "Smart Telecom": {
            "prefixes": ["9610", "9611", "9612", "9620", "9621", "9622", "9630", "9631", "9632", "9640"],
            "mcc": "429",
            "mnc": "03"
        }
    }
},
"NO": {
    "country": "Norway",
    "operators": {
        "Country Code": ["+47"],
        "Telenor Norway": {
            "prefixes": ["4500", "4501", "4502", "4510", "4511", "4512", "4520", "4521", "4522", "4530"],
            "mcc": "242",
            "mnc": "01"
        },
        "Telia Norway": {
            "prefixes": ["4530", "4531", "4532", "4540", "4541", "4542", "4550", "4551", "4552", "4560"],
            "mcc": "242",
            "mnc": "02"
        },
        "Ice.net": {
            "prefixes": ["4560", "4561", "4562", "4570", "4571", "4572", "4580", "4581", "4582", "4590"],
            "mcc": "242",
            "mnc": "03"
        }
    }
},
"SE": {
    "country": "Sweden",
    "operators": {
        "Country Code": ["+46"],
        "Telia": {
            "prefixes": ["7010", "7011", "7012", "7020", "7021", "7022", "7030", "7031", "7032", "7040"],
            "mcc": "240",
            "mnc": "01"
        },
        "Tele2": {
            "prefixes": ["7040", "7041", "7042", "7050", "7051", "7052", "7060", "7061", "7062", "7070"],
            "mcc": "240",
            "mnc": "02"
        },
        "Telenor Sweden": {
            "prefixes": ["7070", "7071", "7072", "7080", "7081", "7082", "7090", "7091", "7092", "7100"],
            "mcc": "240",
            "mnc": "03"
        }
    }
},
    "FI": {
    "country": "Finland",
    "operators": {
        "Country Code": ["+358"],
        "Elisa": {
            "prefixes": ["5000", "5001", "5002", "5010", "5011", "5012", "5020", "5021", "5022", "5030"],
            "mcc": "244",
            "mnc": "05"
        },
        "Telia Finland": {
            "prefixes": ["5030", "5031", "5032", "5040", "5041", "5042", "5050", "5051", "5052", "5060"],
            "mcc": "244",
            "mnc": "91"
        },
        "DNA": {
            "prefixes": ["5060", "5061", "5062", "5070", "5071", "5072", "5080", "5081", "5082", "5090"],
            "mcc": "244",
            "mnc": "12"
        }
    }
},
"DK": {
    "country": "Denmark",
    "operators": {
        "Country Code": ["+45"],
        "TDC": {
            "prefixes": ["4010", "4011", "4012", "4020", "4021", "4022", "4030", "4031", "4032", "4040"],
            "mcc": "238",
            "mnc": "01"
        },
        "3 Denmark": {
            "prefixes": ["4040", "4041", "4042", "4050", "4051", "4052", "4060", "4061", "4062", "4070"],
            "mcc": "238",
            "mnc": "06"
        },
        "Telia Denmark": {
            "prefixes": ["4070", "4071", "4072", "4080", "4081", "4082", "4090", "4091", "4092", "4100"],
            "mcc": "238",
            "mnc": "02"
        }
    }
},
"IS": {
    "country": "Iceland",
    "operators": {
        "Country Code": ["+354"],
        "Síminn": {
            "prefixes": ["7700", "7701", "7702", "7710", "7711", "7712", "7720", "7721", "7722", "7730"],
            "mcc": "274",
            "mnc": "01"
        },
        "Vodafone Iceland": {
            "prefixes": ["7730", "7731", "7732", "7740", "7741", "7742", "7750", "7751", "7752", "7760"],
            "mcc": "274",
            "mnc": "02"
        }
    }
},
"IE": {
    "country": "Ireland",
    "operators": {
        "Country Code": ["+353"],
        "Vodafone Ireland": {
            "prefixes": ["8700", "8701", "8702", "8710", "8711", "8712", "8720", "8721", "8722", "8730"],
            "mcc": "272",
            "mnc": "01"
        },
        "Three Ireland": {
            "prefixes": ["8730", "8731", "8732", "8740", "8741", "8742", "8750", "8751", "8752", "8760"],
            "mcc": "272",
            "mnc": "02"
        },
        "Eir": {
            "prefixes": ["8760", "8761", "8762", "8770", "8771", "8772", "8780", "8781", "8782", "8790"],
            "mcc": "272",
            "mnc": "03"
        }
    }
},
"BE": {
    "country": "Belgium",
    "operators": {
        "Country Code": ["+32"],
        "Proximus": {
            "prefixes": ["4710", "4711", "4712", "4720", "4721", "4722", "4730", "4731", "4732", "4740"],
            "mcc": "206",
            "mnc": "01"
        },
        "Orange Belgium": {
            "prefixes": ["4740", "4741", "4742", "4750", "4751", "4752", "4760", "4761", "4762", "4770"],
            "mcc": "206",
            "mnc": "10"
        },
        "Telenet": {
            "prefixes": ["4770", "4771", "4772", "4780", "4781", "4782", "4790", "4791", "4792", "4800"],
            "mcc": "206",
            "mnc": "20"
        }
    }
},
    "NL": {
    "country": "Netherlands",
    "operators": {
        "Country Code": ["+31"],
        "KPN": {
            "prefixes": ["6000", "6001", "6002", "6010", "6011", "6012", "6020", "6021", "6022", "6030"],
            "mcc": "204",
            "mnc": "08"
        },
        "Vodafone Netherlands": {
            "prefixes": ["6030", "6031", "6032", "6040", "6041", "6042", "6050", "6051", "6052", "6060"],
            "mcc": "204",
            "mnc": "04"
        },
        "T-Mobile Netherlands": {
            "prefixes": ["6060", "6061", "6062", "6070", "6071", "6072", "6080", "6081", "6082", "6090"],
            "mcc": "204",
            "mnc": "16"
        }
    }
},
"CH": {
    "country": "Switzerland",
    "operators": {
        "Country Code": ["+41"],
        "Swisscom": {
            "prefixes": ["7810", "7811", "7812", "7820", "7821", "7822", "7830", "7831", "7832", "7840"],
            "mcc": "228",
            "mnc": "01"
        },
        "Salt": {
            "prefixes": ["7840", "7841", "7842", "7850", "7851", "7852", "7860", "7861", "7862", "7870"],
            "mcc": "228",
            "mnc": "03"
        },
        "Sunrise": {
            "prefixes": ["7870", "7871", "7872", "7880", "7881", "7882", "7890", "7891", "7892", "7900"],
            "mcc": "228",
            "mnc": "02"
        }
    }
},
"CZ": {
    "country": "Czech Republic",
    "operators": {
        "Country Code": ["+420"],
        "O2 Czech Republic": {
            "prefixes": ["6010", "6011", "6012", "6020", "6021", "6022", "6030", "6031", "6032", "6040"],
            "mcc": "230",
            "mnc": "02"
        },
        "Vodafone CZ": {
            "prefixes": ["6040", "6041", "6042", "6050", "6051", "6052", "6060", "6061", "6062", "6070"],
            "mcc": "230",
            "mnc": "01"
        },
        "T-Mobile CZ": {
            "prefixes": ["6070", "6071", "6072", "6080", "6081", "6082", "6090", "6091", "6092", "6100"],
            "mcc": "230",
            "mnc": "03"
        }
    }
},
"HU": {
    "country": "Hungary",
    "operators": {
        "Country Code": ["+36"],
        "Magyar Telekom": {
            "prefixes": ["7010", "7011", "7012", "7020", "7021", "7022", "7030", "7031", "7032", "7040"],
            "mcc": "216",
            "mnc": "30"
        },
        "Telenor Hungary": {
            "prefixes": ["7040", "7041", "7042", "7050", "7051", "7052", "7060", "7061", "7062", "7070"],
            "mcc": "216",
            "mnc": "01"
        },
        "Vodafone Hungary": {
            "prefixes": ["7070", "7071", "7072", "7080", "7081", "7082", "7090", "7091", "7092", "7100"],
            "mcc": "216",
            "mnc": "70"
        }
    }
},
"BR": {
    "country": "Brazil",
    "operators": {
        "Country Code": ["+55"],
        "Vivo": {
            "prefixes": ["0110", "0111", "0112", "0120", "0121", "0122", "0130", "0131", "0132", "0140"],
            "mcc": "724",
            "mnc": "10"
        },
        "Claro Brazil": {
            "prefixes": ["0210", "0211", "0212", "0220", "0221", "0222", "0230", "0231", "0232", "0240"],
            "mcc": "724",
            "mnc": "05"
        },
        "TIM Brazil": {
            "prefixes": ["0310", "0311", "0312", "0320", "0321", "0322", "0330", "0331", "0332", "0340"],
            "mcc": "724",
            "mnc": "03"
        }
    }
},
    "CL": {
    "country": "Chile",
    "operators": {
        "Country Code": ["+56"],
        "Entel Chile": {
            "prefixes": ["9710", "9711", "9712", "9720", "9721", "9722", "9730", "9731", "9732", "9740"],
            "mcc": "730",
            "mnc": "01"
        },
        "Movistar Chile": {
            "prefixes": ["9810", "9811", "9812", "9820", "9821", "9822", "9830", "9831", "9832", "9840"],
            "mcc": "730",
            "mnc": "02"
        },
        "Claro Chile": {
            "prefixes": ["9910", "9911", "9912", "9920", "9921", "9922", "9930", "9931", "9932", "9940"],
            "mcc": "730",
            "mnc": "03"
        }
    }
},
"PE": {
    "country": "Peru",
    "operators": {
        "Country Code": ["+51"],
        "Movistar Peru": {
            "prefixes": ["9100", "9101", "9102", "9110", "9111", "9112", "9120", "9121", "9122", "9130"],
            "mcc": "716",
            "mnc": "06"
        },
        "Claro Peru": {
            "prefixes": ["9200", "9201", "9202", "9210", "9211", "9212", "9220", "9221", "9222", "9230"],
            "mcc": "716",
            "mnc": "10"
        },
        "Entel Peru": {
            "prefixes": ["9300", "9301", "9302", "9310", "9311", "9312", "9320", "9321", "9322", "9330"],
            "mcc": "716",
            "mnc": "17"
        }
    }
},
"VE": {
    "country": "Venezuela",
    "operators": {
        "Country Code": ["+58"],
        "Movilnet": {
            "prefixes": ["4120", "4121", "4122", "4140", "4141", "4142", "4160", "4161", "4162", "4170"],
            "mcc": "734",
            "mnc": "06"
        },
        "Digitel": {
            "prefixes": ["4141", "4142", "4143", "4161", "4162", "4163", "4121", "4122", "4123", "4130"],
            "mcc": "734",
            "mnc": "02"
        },
        "Movistar Venezuela": {
            "prefixes": ["4162", "4163", "4164", "4165", "4166", "4167", "4168", "4169", "4170", "4180"],
            "mcc": "734",
            "mnc": "03"
        }
    }
},
"UY": {
    "country": "Uruguay",
    "operators": {
        "Country Code": ["+598"],
        "Antel": {
            "prefixes": ["0900", "0901", "0902", "0910", "0911", "0912", "0920", "0921", "0922", "0930"],
            "mcc": "748",
            "mnc": "10"
        },
        "Movistar Uruguay": {
            "prefixes": ["0930", "0931", "0932", "0940", "0941", "0942", "0950", "0951", "0952", "0960"],
            "mcc": "748",
            "mnc": "07"
        },
        "Claro Uruguay": {
            "prefixes": ["0960", "0961", "0962", "0970", "0971", "0972", "0980", "0981", "0982", "0990"],
            "mcc": "748",
            "mnc": "06"
        }
    }
},
"PY": {
    "country": "Paraguay",
    "operators": {
        "Country Code": ["+595"],
        "Tigo Paraguay": {
            "prefixes": ["9710", "9711", "9712", "9720", "9721", "9722", "9730", "9731", "9732", "9740"],
            "mcc": "744",
            "mnc": "02"
        },
        "Claro Paraguay": {
            "prefixes": ["9810", "9811", "9812", "9820", "9821", "9822", "9830", "9831", "9832", "9840"],
            "mcc": "744",
            "mnc": "03"
        },
        "Personal Paraguay": {
            "prefixes": ["9910", "9911", "9912", "9920", "9921", "9922", "9930", "9931", "9932", "9940"],
            "mcc": "744",
            "mnc": "01"
        }
    }
},
    "BO": {
    "country": "Bolivia",
    "operators": {
        "Country Code": ["+591"],
        "Entel Bolivia": {
            "prefixes": ["7010", "7011", "7012", "7020", "7021", "7022", "7030", "7031", "7032", "7040"],
            "mcc": "736",
            "mnc": "01"
        },
        "Tigo Bolivia": {
            "prefixes": ["7040", "7041", "7042", "7050", "7051", "7052", "7060", "7061", "7062", "7070"],
            "mcc": "736",
            "mnc": "02"
        },
        "Viva": {
            "prefixes": ["7070", "7071", "7072", "7080", "7081", "7082", "7090", "7091", "7092", "7100"],
            "mcc": "736",
            "mnc": "03"
        }
    }
},
"EC": {
    "country": "Ecuador",
    "operators": {
        "Country Code": ["+593"],
        "Claro Ecuador": {
            "prefixes": ["9900", "9901", "9902", "9910", "9911", "9912", "9920", "9921", "9922", "9930"],
            "mcc": "740",
            "mnc": "05"
        },
        "Movistar Ecuador": {
            "prefixes": ["9930", "9931", "9932", "9940", "9941", "9942", "9950", "9951", "9952", "9960"],
            "mcc": "740",
            "mnc": "02"
        }
    }
},
"PA": {
    "country": "Panama",
    "operators": {
        "Country Code": ["+507"],
        "Claro Panama": {
            "prefixes": ["6000", "6001", "6002", "6010", "6011", "6012", "6020", "6021", "6022", "6030"],
            "mcc": "714",
            "mnc": "02"
        },
        "Movistar Panama": {
            "prefixes": ["6030", "6031", "6032", "6040", "6041", "6042", "6050", "6051", "6052", "6060"],
            "mcc": "714",
            "mnc": "03"
        },
        "Digicel Panama": {
            "prefixes": ["6060", "6061", "6062", "6070", "6071", "6072", "6080", "6081", "6082", "6090"],
            "mcc": "714",
            "mnc": "04"
        }
    }
},
"CR": {
    "country": "Costa Rica",
    "operators": {
        "Country Code": ["+506"],
        "ICE": {
            "prefixes": ["8310", "8311", "8312", "8320", "8321", "8322", "8330", "8331", "8332", "8340"],
            "mcc": "712",
            "mnc": "01"
        },
        "Claro Costa Rica": {
            "prefixes": ["8340", "8341", "8342", "8350", "8351", "8352", "8360", "8361", "8362", "8370"],
            "mcc": "712",
            "mnc": "02"
        },
        "Movistar Costa Rica": {
            "prefixes": ["8370", "8371", "8372", "8380", "8381", "8382", "8390", "8391", "8392", "8400"],
            "mcc": "712",
            "mnc": "03"
        }
    }
},
"HN": {
    "country": "Honduras",
    "operators": {
        "Country Code": ["+504"],
        "Tigo Honduras": {
            "prefixes": ["9810", "9811", "9812", "9820", "9821", "9822", "9830", "9831", "9832", "9840"],
            "mcc": "708",
            "mnc": "02"
        },
        "Claro Honduras": {
            "prefixes": ["9840", "9841", "9842", "9850", "9851", "9852", "9860", "9861", "9862", "9870"],
            "mcc": "708",
            "mnc": "03"
        }
    }
},
    "SV": {
    "country": "El Salvador",
    "operators": {
        "Country Code": ["+503"],
        "Tigo El Salvador": {
            "prefixes": ["7010", "7011", "7012", "7020", "7021", "7022", "7030", "7031", "7032"],
            "mcc": "706",
            "mnc": "01"
        },
        "Claro El Salvador": {
            "prefixes": ["7040", "7041", "7042", "7050", "7051", "7052", "7060", "7061", "7062"],
            "mcc": "706",
            "mnc": "02"
        }
    }
},
"GT": {
    "country": "Guatemala",
    "operators": {
        "Country Code": ["+502"],
        "Claro Guatemala": {
            "prefixes": ["3010", "3011", "3012", "3020", "3021", "3022", "3030", "3031", "3032"],
            "mcc": "704",
            "mnc": "01"
        },
        "Tigo Guatemala": {
            "prefixes": ["3040", "3041", "3042", "3050", "3051", "3052", "3060", "3061", "3062"],
            "mcc": "704",
            "mnc": "02"
        }
    }
},
"CU": {
    "country": "Cuba",
    "operators": {
        "Country Code": ["+53"],
        "ETECSA": {
            "prefixes": ["5200", "5201", "5202", "5210", "5211", "5212", "5220", "5221", "5222"],
            "mcc": "368",
            "mnc": "01"
        }
    }
},
"JM": {
    "country": "Jamaica",
    "operators": {
        "Country Code": ["+1-876"],
        "Digicel Jamaica": {
            "prefixes": ["6010", "6011", "6012", "6020", "6021", "6022", "6030", "6031", "6032"],
            "mcc": "338",
            "mnc": "05"
        },
        "Flow Jamaica": {
            "prefixes": ["6040", "6041", "6042", "6050", "6051", "6052", "6060", "6061", "6062"],
            "mcc": "338",
            "mnc": "01"
        }
    }
},
"TT": {
    "country": "Trinidad and Tobago",
    "operators": {
        "Country Code": ["+1-868"],
        "TSTT": {
            "prefixes": ["6500", "6501", "6502", "6510", "6511", "6512", "6520", "6521", "6522"],
            "mcc": "374",
            "mnc": "12"
        },
        "Digicel Trinidad": {
            "prefixes": ["6530", "6531", "6532", "6540", "6541", "6542", "6550", "6551", "6552"],
            "mcc": "374",
            "mnc": "13"
        }
    }
},
    "BB": {
    "country": "Barbados",
    "operators": {
        "Country Code": ["+1-246"],
        "Digicel Barbados": {
            "prefixes": ["7000", "7001", "7002", "7010", "7011", "7012", "7020", "7021", "7022"],
            "mcc": "342",
            "mnc": "01"
        },
        "Flow Barbados": {
            "prefixes": ["7030", "7031", "7032", "7040", "7041", "7042", "7050", "7051", "7052"],
            "mcc": "342",
            "mnc": "02"
        }
    }
},
}
# Keeping the data structure same as before
class PhoneNumberRequest(BaseModel):
    number: str
    country: Optional[str] = None  # Optional country parameter

@app.get("/", response_class=HTMLResponse)
async def serve_homepage(request: Request):
    return templates.TemplateResponse("index.html", {"request": request})

@app.post("/check-number")
def check_phone_number(request: PhoneNumberRequest):
    logging.debug(f"Received request: {request}")

    number = request.number.strip()
    if len(number) < 4:
        raise HTTPException(status_code=400, detail="Invalid phone number: too short")

    selected_country = (request.country or "").strip().lower()

    if selected_country:
        matching_country_codes = [
            c_code
            for c_code, data in TELECOM_DATA.items()
            if data["country"].lower() == selected_country
        ]
        if not matching_country_codes:
            raise HTTPException(
                status_code=404, detail=f"No data for '{request.country}'"
            )
        country_codes_to_search = matching_country_codes
    else:
        country_codes_to_search = TELECOM_DATA.keys()

    prefix = number[:4]
    for code in country_codes_to_search:
        country_data = TELECOM_DATA[code]
        for operator, details in country_data["operators"].items():
            if not isinstance(details, dict) or "prefixes" not in details:
                continue

            if prefix in details["prefixes"]:
                response = {
                    "country": country_data["country"],
                    "country_code": country_data["operators"].get("Country Code", ["N/A"])[0],
                    "operator": operator,
                    "prefix": prefix,
                    "mcc": details.get("mcc"),
                    "mnc": details.get("mnc"),
                }
                logging.info(f"Match found: {response}")
                return response

    raise HTTPException(status_code=404, detail="Number not found in database")
